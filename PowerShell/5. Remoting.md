# Remoting

PowerShell Remoting lets you run PowerShell commands or access full PowerShell sessions on remote Windows systems. Itâ€™s similar to SSH for accessing remote terminals on other operating systems.

## Enable Powershell remoting on the PC you want to access remotely

PowerShell is locked-down by default, so youâ€™ll have to enable PowerShell Remoting before using it:

- Open PowerShell as Adminitrator (Windows+X in win10).
- In the PowerShell window, type:

    ```powershell
    PS C:\> Enable-PSRemoting -Force
    ```

    This command starts the WinRM service, sets it to start automatically with your system, and creates a firewall rule that allows incoming connections. The `-Force` part of the cmdlet tells PowerShell to perform these actions without prompting you for each step.

If your computers arenâ€™t on a domain, you need to perform a few more steps to get things set up.

Configure the `TrustedHosts` setting on both the PC to which you want to connect and the PC (or PCs) you want to connect from, so the computers will trust each other.

- If youâ€™re on a home network where you want to go ahead and trust any PC to connect remotely, you can type the following cmdlet in PowerShell (again, youâ€™ll need to run it as Administrator).

    ```powershell
    PS C:\> Set-Item wsman:\localhost\client\trustedhosts *
    PS C:\> Restart-Service WinRM
    ```

- If instead you want to restrict computers that can connect, you can replace the asterisk with a comma-separated list of IP addresses or computer names for approved PCs.

### Test de Connection

```powershell
PS C:\> Test-WsMan COMPUTER

# replacing â€œCOMPUTERâ€ with the name or IP address of the remote PC
```

## Invoke-command

The `Invoke-Command` cmdlet runs commands on a local or remote computer and returns all output from the commands, including errors. By using a single `Invoke-Command`, you can run commands on multiple computers.

- One to one:

    ```powershell
    PS C:\> Invoke-Command -FilePath c:\scripts\test.ps1 -ComputerName Server01

    # This command runs the Test.ps1 script on the Server01 computer.
    ```

- One to many:

    ```powershell
    PS C:\> Invoke-Command -ComputerName server01 -Credential domain01\user01 -ScriptBlock {Get-Culture}

    # This command runs a Get-Culture command on the Server01 remote computer.
    ```

    >ðŸ’¡ `Invoke-Command` has an alias: `icm`

    ```powershell
    PS C:\> icm server01, server02 { get-eventlog -LogName system -new 3}
    ```
